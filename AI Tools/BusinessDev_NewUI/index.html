<!DOCTYPE html>
<html lang="en" class="h-full bg-blue-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/businessdev/">
    <title>BusinessDev - MSMM Dashboard</title>
    <link href="dist/output.css" rel="stylesheet">
    <script src="js/config.js"></script>
    <script src="js/toast.js"></script>
    <script src="js/button-utils.js"></script>
</head>
<body class="h-full">
    <!-- Navbar -->
    <nav class="relative bg-white shadow-sm">
        <div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-8">
            <div class="relative flex h-16 justify-between">
                <!-- Mobile menu button -->
                <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
                    <button type="button" id="mobile-menu-btn" class="group relative inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:ring-2 focus:ring-indigo-600 focus:outline-none focus:ring-inset">
                        <span class="sr-only">Open main menu</span>
                        <svg id="menu-open-icon" class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                        </svg>
                        <svg id="menu-close-icon" class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <!-- Logo and navigation -->
                <div class="flex flex-1 items-center justify-center sm:items-stretch sm:justify-start">
                    <div class="flex shrink-0 items-center">
                        <img class="h-10 w-auto" src="assets/images/msmm-logo.png" alt="MSMM Engineering">
                    </div>
                    <!-- Desktop navigation -->
                    <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="https://www.msmmai.com/" class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700">
                            üè† MSMM AI Home
                        </a>
                        <a href="pages/calendar.html" class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700">
                            üìÖ Calendar
                        </a>
                        <a href="pages/organizations.html" class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700">
                            üè¢ Organizations
                        </a>
                        <a href="https://www.msmmai.com/licenseremindertool/" data-license-count class="inline-flex items-center gap-1 border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700">
                            üîê License Manager
                            <span class="license-count hidden text-amber-600 font-semibold"></span>
                        </a>
                    </div>
                </div>

                <!-- Profile section -->
                <div class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0">
                    <div class="relative ml-3">
                        <button type="button" id="profile-menu-btn" class="relative flex rounded-full focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                            <span class="sr-only">Open user menu</span>
                            <img class="h-8 w-8 rounded-full bg-gray-100 outline outline-1 -outline-offset-1 outline-black/5" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
                        </button>

                        <!-- Profile dropdown -->
                        <div id="profile-dropdown" class="hidden absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Your profile</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile menu panel -->
        <div id="mobile-menu" class="hidden sm:hidden">
            <div class="space-y-1 pt-2 pb-4">
                <a href="https://www.msmmai.com/" class="block border-l-4 border-transparent py-2 pr-4 pl-3 text-base font-medium text-gray-500 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-700">üè† MSMM AI Home</a>
                <a href="pages/calendar.html" class="block border-l-4 border-transparent py-2 pr-4 pl-3 text-base font-medium text-gray-500 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-700">üìÖ Calendar</a>
                <a href="pages/organizations.html" class="block border-l-4 border-transparent py-2 pr-4 pl-3 text-base font-medium text-gray-500 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-700">üè¢ Organizations</a>
                <a href="https://www.msmmai.com/licenseremindertool/" data-license-count class="block border-l-4 border-transparent py-2 pr-4 pl-3 text-base font-medium text-gray-500 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-700">
                    üîê License Manager <span class="license-count hidden text-amber-600 font-semibold"></span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main content -->
    <main class="py-12">
        <div class="px-6 sm:px-8 lg:px-12 max-w-[1600px] mx-auto">
            <!-- Page header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900">MSMM Business Development Dashboard</h1>
                <p class="mt-2 text-sm text-gray-600">Track and manage all your business development activities</p>
            </div>

            <!-- Project Avenue Organizations Section -->
            <div class="mb-6 bg-white shadow rounded-lg border border-gray-200 p-4">
                <div class="flex items-center justify-between mb-3">
                    <h2 class="text-lg font-semibold text-gray-900 flex items-center">
                        <svg class="h-5 w-5 text-teal-600 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z" />
                        </svg>
                        Project Avenue - By Organization
                    </h2>
                    <a href="pages/table.html?type=project-avenue" class="text-sm text-teal-600 hover:text-teal-700 font-medium">
                        View All (<span id="count-project-avenue-top">-</span>) ‚Üí
                    </a>
                </div>
                <div class="relative">
                    <select id="project-avenue-org-select" class="block w-full rounded-md border-0 py-2 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-teal-600 sm:text-sm">
                        <option value="">Select an organization to view awarded projects...</option>
                        <!-- Organizations will be loaded here -->
                    </select>
                </div>
            </div>

            <!-- Cards Grid -->
            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">

                <!-- Card 1: Future Pursuits -->
                <div class="bg-white overflow-hidden shadow rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-indigo-100 rounded-md p-3">
                                    <svg class="h-6 w-6 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Future Pursuits</h3>
                        <div class="space-y-2">
                            <a href="pages/table.html?type=future-pursuits" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Future Pursuits</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-future-pursuits">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-pursuits" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Archived Pursuits</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-pursuits">-</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Card 2: Proposals -->
                <div class="bg-white overflow-hidden shadow rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-green-100 rounded-md p-3">
                                    <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Proposals</h3>
                        <div class="space-y-2">
                            <a href="pages/table.html?type=active-proposals" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Active Proposals</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-active-proposals">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-proposals" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Archived Proposals</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-proposals">-</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Card 3: Multi-Use Contracts -->
                <div class="bg-white overflow-hidden shadow rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-blue-100 rounded-md p-3">
                                    <svg class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Multi-Use Contracts</h3>
                        <div class="space-y-2">
                            <a href="pages/table.html?type=active-prime-multiuse" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs">Active Prime Multi-Use</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-active-prime-multiuse">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=active-sub-multiuse" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs">Active Sub Multi-Use</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-active-sub-multiuse">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-prime-multiuse" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs">Archived Prime</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-prime-multiuse">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-sub-multiuse" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs">Archived Sub</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-sub-multiuse">-</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Card 4: AE Selected List -->
                <div class="bg-white overflow-hidden shadow rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-purple-100 rounded-md p-3">
                                    <svg class="h-6 w-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0118 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3l1.5 1.5 3-3.75" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">AE Selected List</h3>
                        <div class="space-y-2">
                            <a href="pages/table.html?type=active-ae-selected" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Active AE Selected</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-active-ae-selected">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-ae-selected" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Archived AE Selected</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-ae-selected">-</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Card 5: Single Use Contracts -->
                <div class="bg-white overflow-hidden shadow rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-yellow-100 rounded-md p-3">
                                    <svg class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Single Use Contracts</h3>
                        <div class="space-y-2">
                            <a href="pages/table.html?type=active-single-use" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Active Projects</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-active-single-use">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-single-use" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Archived Projects</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-single-use">-</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Card 6: Fee Proposals -->
                <div class="bg-white overflow-hidden shadow rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-red-100 rounded-md p-3">
                                    <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Fee Proposals</h3>
                        <div class="space-y-2">
                            <a href="pages/table.html?type=active-fee-proposals" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Active Fee Proposals</span>
                                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="count-active-fee-proposals">-</span>
                                </div>
                            </a>
                            <a href="pages/table.html?type=archived-fee-proposals" class="block text-sm text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded p-2 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>Archived Fee Proposals</span>
                                    <span class="text-xs bg-pink-100 text-pink-600 px-2 py-1 rounded-full" id="count-archived-fee-proposals">-</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const menuOpenIcon = document.getElementById('menu-open-icon');
        const menuCloseIcon = document.getElementById('menu-close-icon');

        mobileMenuBtn.addEventListener('click', () => {
            const isHidden = mobileMenu.classList.contains('hidden');

            if (isHidden) {
                mobileMenu.classList.remove('hidden');
                menuOpenIcon.classList.add('hidden');
                menuCloseIcon.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
                menuOpenIcon.classList.remove('hidden');
                menuCloseIcon.classList.add('hidden');
            }
        });

        // Profile dropdown toggle
        const profileMenuBtn = document.getElementById('profile-menu-btn');
        const profileDropdown = document.getElementById('profile-dropdown');

        profileMenuBtn.addEventListener('click', () => {
            profileDropdown.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!profileMenuBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
                profileDropdown.classList.add('hidden');
            }
        });

        // Load Project Avenue organizations
        async function loadProjectAvenueOrganizations() {
            try {
                const response = await fetch(`${window.API_CONFIG.baseUrl}/api/project-avenue/organizations`);
                const result = await response.json();

                if (result.success) {
                    const select = document.getElementById('project-avenue-org-select');
                    
                    // Clear existing options except the first one
                    while (select.options.length > 1) {
                        select.remove(1);
                    }

                    result.data.forEach(org => {
                        const option = document.createElement('option');
                        option.value = org.ORG_FULL_NAME;
                        option.textContent = org.OLABEL || org.ORG_FULL_NAME;
                        select.appendChild(option);
                    });

                    if (result.data.length === 0) {
                        const option = document.createElement('option');
                        option.disabled = true;
                        option.textContent = 'No organizations found';
                        select.appendChild(option);
                    }
                }
            } catch (error) {
                console.error('Error loading Project Avenue organizations:', error);
            }
        }

        // Handle organization selection
        const orgSelect = document.getElementById('project-avenue-org-select');
        if (orgSelect) {
            orgSelect.addEventListener('change', (e) => {
                const selectedOrg = e.target.value;
                if (selectedOrg) {
                    window.location.href = `pages/table.html?type=project-avenue&CLIENT_NAME=${encodeURIComponent(selectedOrg)}`;
                }
            });
        }

        // Load counts from API
        async function loadCounts() {
            try {
                const response = await fetch(`${window.API_CONFIG.baseUrl}/api/proposals/counts`);
                const result = await response.json();

                if (result.success) {
                    const counts = result.data;

                    // Update Future Pursuits counts
                    document.getElementById('count-future-pursuits').textContent = counts.futurePursuits || 0;
                    document.getElementById('count-archived-pursuits').textContent = counts.archivedPursuits || 0;

                    // Update Proposals counts
                    document.getElementById('count-active-proposals').textContent = counts.activeProposals || 0;
                    document.getElementById('count-archived-proposals').textContent = counts.archivedProposals || 0;

                    // Update Multi-Use Contracts counts
                    document.getElementById('count-active-prime-multiuse').textContent = counts.activePrimeMultiuse || 0;
                    document.getElementById('count-active-sub-multiuse').textContent = counts.activeSubMultiuse || 0;
                    document.getElementById('count-archived-prime-multiuse').textContent = counts.archivedPrimeMultiuse || 0;
                    document.getElementById('count-archived-sub-multiuse').textContent = counts.archivedSubMultiuse || 0;

                    // Update AE Selected List counts
                    document.getElementById('count-active-ae-selected').textContent = counts.activeAESelected || 0;
                    document.getElementById('count-archived-ae-selected').textContent = counts.archivedAESelected || 0;

                    // Update Single Use Contracts counts
                    document.getElementById('count-active-single-use').textContent = counts.activeSingleUse || 0;
                    document.getElementById('count-archived-single-use').textContent = counts.archivedSingleUse || 0;

                    // Update Fee Proposals counts
                    document.getElementById('count-active-fee-proposals').textContent = counts.activeFeeProposals || 0;
                    document.getElementById('count-archived-fee-proposals').textContent = counts.archivedFeeProposals || 0;

                    // Update Project Avenue count (top section only)
                    document.getElementById('count-project-avenue-top').textContent = counts.projectAvenue || 0;
                } else {
                    console.error('Failed to load counts:', result.error);
                }
            } catch (error) {
                console.error('Error loading counts:', error);
            }
        }

        // Load counts and organizations when page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadCounts();
            loadProjectAvenueOrganizations();
        });
    </script>
    <script src="js/license-count.js"></script>
</body>
</html>
